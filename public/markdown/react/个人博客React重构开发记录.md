# 起步

本来想自己`webpack`配一遍的，然后懒了点就直接`create-react-app`了

# 项目结构

因为是个静态博客，所以文章信息分成两个js来保存，为了性能优化将分类和文章详情分开；同时因为一篇文章的添加涉及到了两个文件，所以编写脚本来控制文章的发布和删除。其他目录与传统`React`项目结构类似，并且没有什么上`Redux`的必要，实用就好不搞些其他花里胡哨的。

```
React-blog
│   README.md
│   file.js   // 文章创建发布脚本
|   package.json  
│
└───src
│   │   App.js    // 单页应用最外层组件
│   │   index.js    // 入口文件
│   │
│   └───component
│   │
|   └───constant
│   │     category.js   // 分类信息
|   |     friends.js    // 友情链接
|   |     markdown.js   // 文章信息
|   |
|   └───container
│   │
|   └───markdown    // 存放markdown文件
│   │     └───react   // 分类文件夹
|   |     └───javascript
|   |     └───...
|   └───style
|
└───scripts   // 项目运行脚本
|
└───config    // webpack配置等
|
└───node_modules
|
└───public
```

# 一些我想讲的地方

## 组件

设计时`component`和`container`要区分开来，需求拆分是个很重要的技能，拆分好后再来设计自己的组件。

关于组件没什么讲的，提一下的就是我把`scss`和`jsx`放到了同一个目录下，因为文件数量本来就不多，并且我觉得将一些东西分开来写**有时候**真的很蠢。

我很讨厌`Vue`那种写在一起的语法，但是我对于`Redux`的`Ducks`风格是很欣赏的(对于中小型项目来讲)，对于团队合作的大型项目来讲，我还是比较喜欢类似`MVC`和`Domain`的风格

## 兼容性

哦Shit，我的博客受众可不是那些用`IE8`的客户，能做的我已经让打包工具帮我做了，我会好好做一下移动端适配，但是兼容性方面不要来找我了(但是在公司维护支持`IE8`的`style`和`js`真很刺激)

## 优化

大部分交给`Webpack`了，但因为是单页应用并且博客是`dev`环境跑在服务器上的，还是要加载一份接近`1M`的js文件(委屈)，这段时间我会抽空解决下，不过我服务器的小水管是解决不了了

## 文章管理脚本

因为是静态博客，每次新建一篇文章就要修改2个js文件，其中包括: 标题，简介，时间(这个竟然要我手动输入)，分类。虽然不多但是还是有点麻烦的，并且考虑到删除...

然后就随手撸了个小脚本，用了`commander`和`inquirer`，`fs`写文件就好了，这里我没用`fs`来读文件，因为读出来的字符串很难去进行操作，所以就直接`require`进来了(我真是个小机灵鬼)；记得写文件的时候要把内容转成字符串并且做好格式化。

## 文章加载

各种数据我基本都是拼在`url`里来传递的，关于`url`的解析我用了自己写的库`j2url`(感兴趣的可以npm搜一下)；拿到参数后直接`require`目录获取内容然后`dangerouslySetInnerHTML`渲染就好了

`require`操作需要`try catch`，不然网页上会抛出异常，对于错误的`url`要设置好`404`页面

`markdown`的样式我参考了`Vue`的清新风格，代码高亮我参考的是`Outrun Electric`(这两份scss是我写的最难受的)

## 博客样式

没有灵感，撸成什么样算什么样，开始是灰白风，后来觉得真的丑，换成了蓝色冰淇淋风，感觉美的不行

## 难点

无。这种业务层面的东西真的没啥高深的技术点，绝大部分基础的技术点我也不想提了，大多数还是要看经验的累积以及个人的基础了。有时候难点不只是在`Coding`上的...

## 后记更新

### 2018-11-12

撸了一个mac主题后，发现这个适配移动端真的太难了，幸好原来的主题没有舍弃，于是改了下`Webpack`打包，通过`chunk`打包多入口多出口，并且生成两份`HTML`文件，分别对应PC端和移动端，之后在`Nginx`中判断用户访问设备来加载指定`Root`

因为修改后`index.html`路径与原来有异，其与静态资源处于同一层级的子目录，所以在Nginx中统一配置静态资源的路径

### 2018-11-14

WebHook配置，服务器起一个端口监听，然后通过`Nginx`反向代理对应外部`POST`的URL到该端口即可
